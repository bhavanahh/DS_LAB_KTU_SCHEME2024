#include <stdio.h>
#include <ctype.h>
#include <math.h>

char stack[100];
int top = -1;

void push(char x) {
    stack[++top] = x;
}

char pop() {
    if (top == -1)
        return -1;
    else
        return stack[top--];
}

int priority(char x) {
    if (x == '^')
        return 3;
    else if (x == '*' || x == '/')
        return 2;
    else if (x == '+' || x == '-')
        return 1;
    else
        return 0;
}

int main() {
    char exp[100];
    char postfix[100];
    char *e, x;
    int i = 0;

    printf("Enter the infix expression: ");
    scanf("%s", exp);

    e = exp;

    // --- INFIX TO POSTFIX CONVERSION ---
    while (*e != '\0') {
        if (isalnum(*e)) {
            postfix[i++] = *e;
        } else if (*e == '(') {
            push(*e);
        } else if (*e == ')') {
            while ((x = pop()) != '(')
                postfix[i++] = x;
        } else {
            while (top != -1 && priority(stack[top]) >= priority(*e))
                postfix[i++] = pop();
            push(*e);
        }
        e++;
    }

    while (top != -1)
        postfix[i++] = pop();

    postfix[i] = '\0';

    printf("\nPostfix expression: %s\n", postfix);

    // --- POSTFIX EVALUATION ---
    int evalStack[100];
    int evalTop = -1;
    e = postfix;
    int n1, n2, result;

    while (*e != '\0') {
        if (isdigit(*e)) {
            evalStack[++evalTop] = *e - '0'; // Convert char to int
        } else {
            n2 = evalStack[evalTop--];
            n1 = evalStack[evalTop--];

            switch (*e) {
                case '+': result = n1 + n2; break;
                case '-': result = n1 - n2; break;
                case '*': result = n1 * n2; break;
                case '/': result = n1 / n2; break;
                case '^': result = pow(n1, n2); break;
            }
            evalStack[++evalTop] = result;
        }
        e++;
    }

    printf("Evaluated result: %d\n", evalStack[evalTop]);

    return 0;
}
 
